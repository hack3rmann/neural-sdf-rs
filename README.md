# Neural Signed Distance Fields

## Сборка

Для сборки проекта необходимы линковщик `clang` и инструменты разработки на `rust` (rust toolchain), при их отсутствии:

```shell
sudo apt install rustup
rustup install stable
cargo --version
```

```output
cargo 1.77.2 (e52e36006 2024-03-26)
```

Сборка консольного приложения в режиме release. Для первой сборки понадобится подключение к интернету, чтобы `cargo` имел возможность подгрузить все необходимые библиотеки.

```shell
cargo build --release
```

Приложение будет находится в каталоге `target/release/` под названием `neural_sdf.exe`. Для указания файла архитектуры нейросети необходимо указать флаг `--arch <FILE>`, для файла параметров нейросети `--weights <FILE>`, для файла тестов `--test <FILE>`. Для замера времени выполнения `--bench`. Подробнее о флагах `--help`.

### Пример

```shell
target/release/radiance_fields --help
target/release/radiance_fields --arch assets/sdf2_arch.txt --weights assets/sdf2_weights.bin --test assets/sdf2_test.bin
```

## Зависимости

Проект использует несколько библиотек (их список с версиями есть в файле `Cargo.toml`), в том числе:

1. `anyhow` - упрощённая работа с ошибками.
2. `bytemuck` - позволяет кроссплатформено безопасно преобразовывать данные в байты и обратно без копирования.
3. `clap` - позволяет очень просто парсить аргументы командной строки.
4. `glam` - предоставляет векторные типы и возможную из реализацию на SIMD (в зависимости от платформы).
5. `kdam` - простые индикаторы загрузки.
6. `rand` - имплементация псевдослучайных чисел.
7. `rayon` - реализует "параллельные итераторы", что позволяет эффективно реализовать параллельный рендеринг на CPU.
8. `serde` - интерфейс сериализации/десериализации для Rust.
9. `static_assertions` - статические проверки типов Rust.
10. `tokio` - предоставляет асинхронный runtime для Rust.
11. `thiserror` - позволяет удобно работать с ошибками в Rust.
12. `pom` - набор комбинаторов для парсинга.

## Отчёт о реализации

1. Реализован прямой проход сети на CPU.
2. Парсинг входных файлов.
3. Обучение без оптимизатора и без демонстрации (см. `src/neural.rs:Network::propagate_back` и `src/neural.rs:Trainer`).

## Отчёт о производительности

Вычислен наименьший результат по двум запускам на моём HUAWEI MateBook 16s / Intel i7 13700H / Intel Iris Xe Graphics / 16 GB.

| Вычислитель/Кол-во проходов | 10000  |
| --------------------------- | ------ |
| CPU (multithread)           | 9.79 с |
